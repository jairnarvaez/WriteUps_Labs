<!-- Sidebar -->
<aside  id="sidebar" class="overflow-y-auto overflow-x-visible fixed top-[70px] left-0 h-[calc(100vh-70px)] w-80 bg-gradient-to-br from-[#0f172a]/95 to-[#1e293b]/95 lg:from-[#0f172a]/80 lg:to-[#1e293b]/80 rounded-tr-[10px] rounded-br-[10px] overflow-hidden transform -translate-x-full lg:translate-x-0 transition-transform duration-300 z-40">
    <div class="p-8 bg-black/30 relative z-10 rounded-b-[20px]">
        <h2 class="sidebar-title mb-1">游띶 Hack Notes</h2>
        <p class="sidebar-subtitle">Explora los writeups paso a paso</p>
    </div>
    
    <nav id="machine-list" class=" mt-3 ml-3 w-[85%] z-10 flex flex-col pl-1">
        <!-- Aqu칤 se insertan las m치quinas din치micamente -->
    </nav>
</aside>

<button 
  id="sidebar-toggle" 
  class="fixed top-1/2 -translate-y-1/2 left-0 w-8 h-14 flex items-center justify-center 
         bg-blue-500/25 hover:bg-blue-500/45 text-white text-xl rounded-r-xl 
         shadow-md transition-all duration-300 z-50 lg:hidden">
  >
</button>
<script>
async function loadMachines() {
    try {
        const response = await fetch("/api/machines-basic/"); 
        const machines = await response.json();

        const list = document.getElementById("machine-list");
        list.innerHTML = "";

        machines.forEach(machine => {
            const button = document.createElement("button");
            button.classList.add("machine-item");

            button.onclick = () => {
                window.location.href = `{{ BASE_URL }}/machines/${machine.slug}`;
            };

            button.innerHTML = `
                <div class="flex gap-2">
                    <div>
                        <div class="machine-name">${machine.name}</div>
                        <div class="machine-platform">${machine.platform}</div>
                    </div>
                    <div class="machine-icon">${machine.emoji}</div>
                </div>
                <div class="mt-1 w-[95%] machine-difficulty difficulty-${machine.difficulty.toLowerCase()}">
                    ${translateDifficulty(machine.difficulty)}
                </div>
            `;

            list.appendChild(button);
        });
    } catch (error) {
        console.error("Error cargando m치quinas:", error);
    }
}

function translateDifficulty(difficulty) {
    switch (difficulty) {
        case "Easy": return "F치cil";
        case "Medium": return "Medio";
        case "Hard": return "Dif칤cil";
        default: return difficulty;
    }
}

document.addEventListener("DOMContentLoaded", loadMachines);
</script>

<script>
const sidebar2 = document.getElementById("sidebar");
const toggle = document.getElementById("sidebar-toggle");

toggle.addEventListener("click", () => {
  sidebar2.classList.toggle("-translate-x-full");

  if (!sidebar2.classList.contains("-translate-x-full")) {
    toggle.classList.add("left-80");  
    toggle.textContent = "<";   
  } else {
    toggle.classList.remove("left-80");
    toggle.classList.add("left-0");
    toggle.textContent = ">";   
  }
});


</script>
